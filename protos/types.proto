syntax = "proto3";

package types;

import "google/protobuf/timestamp.proto";
option go_package = "ms.api/protos/pb/types";

// ############# USER GROUP #############

message Customer {
  string id = 1;
  string first_name = 2;
  string last_name = 3;
  // String format DD-MM-YYYY
  string dob = 4;
  string bvn = 5;
  repeated Address addresses = 6;
  repeated Phone phones = 7;
  Email email = 8;
  enum CustomerStatuses {
    SIGNEDUP = 0;
    REGISTERED = 1;
    VERIFIED = 2;
    ONBOARDED = 3;
    REJECTED = 4;
    EXITED = 5;
  }
  CustomerStatuses status = 9;
  google.protobuf.Timestamp status_ts = 10;
  google.protobuf.Timestamp ts = 11;
}

message Email {
  string address = 1;
  bool verified = 2;
}

message Phone {
  bool primary = 1;
  string number = 2;
  bool verified = 3;
}

message Address {
  bool primary = 1;
  Country country = 2;
  string state = 3;
  string city = 4;
  string street = 5;
  string postcode = 6;
  Coordinates coordinates = 7;
}

message Coordinates {
  float latitude = 1;
  float longitude = 2;
}

message Identity {
  string id = 1;
  Customer customer = 2;
  Organization organization = 3;
  IdentityCredentials credentials = 4;
  enum IdentityStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  IdentityStatuses status = 5;
  google.protobuf.Timestamp status_ts = 6;
  google.protobuf.Timestamp ts = 7;
}

message IdentityCredentials {
  enum IdentityCredentialsTypes {
    LOGIN = 0;
    PIN = 1;
  }
  IdentityCredentialsTypes type = 1;
  string password = 2;
  enum IdentityCredentialsStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  IdentityCredentialsStatuses status = 3;
  google.protobuf.Timestamp status_ts = 4;
  google.protobuf.Timestamp ts = 5;
  google.protobuf.Timestamp update_ts = 6;
}

message Organization {
  string id = 1;
  string name = 2;
  enum OrganizationStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  OrganizationStatuses status = 3;
  google.protobuf.Timestamp status_ts = 4;
  google.protobuf.Timestamp ts = 5;
}

message Staff {
  string id = 1;
  string name = 2;
  string lastName = 3;
  // String format DD-MM-YYYY
  string dob = 4;
  repeated Address addresses = 5;
  repeated Phone phones = 6;
  string email = 7;
  enum StaffStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  StaffStatuses status = 8;
  google.protobuf.Timestamp status_ts = 9;
  google.protobuf.Timestamp ts = 10;
}

message Acceptance {
  string id = 1;
  Content content = 2;
  Customer customer = 3;
  google.protobuf.Timestamp ts = 4;
}

message Questionary {
  string id = 1;
  enum QuestionaryTypes {
    REASONS = 0;
  }
  QuestionaryTypes type = 2;
  repeated QuestionaryQuestion questions = 3;
  enum QuestionaryStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  QuestionaryStatuses status = 4;
  google.protobuf.Timestamp status_ts = 5;
  google.protobuf.Timestamp ts = 6;
}

message QuestionaryQuestion {
  string id = 1;
  string value = 2;
  repeated QuestionaryPredefinedAnswer predefined_answers = 3;
  bool required = 4;
  bool multiple_options = 5;
}

message QuestionaryPredefinedAnswer {
  string id = 1;
  string value = 2;
}

message QuestionaryAnswer {
  string id = 1;
  string questionary_id = 2;
  string customer_id = 3;
  repeated QuestionaryAnswerQuestion questions = 4;
  google.protobuf.Timestamp ts = 7;
}

message QuestionaryAnswerQuestion {
  string id = 1;
  string answer = 2;
  repeated string predefined_answers = 3;
}

message Device {
  string id = 1;
  Customer customer = 2;
  string identifier = 3;
  string os = 4;
  string brand = 5;
  repeated DeviceToken tokens = 6;
  repeated DevicePreferences preferences = 7;
  enum DeviceStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  DeviceStatuses status = 8;
  google.protobuf.Timestamp status_ts = 9;
  google.protobuf.Timestamp ts = 10;
}

message DevicePreferences {
  enum DevicePreferencesTypes {
    PUSH = 0;
    BIOMETRICS = 1;
  }
  DevicePreferencesTypes type = 1;
  bool value = 2;
}

message DeviceToken {
  enum DeviceTokenTypes {
    FIREBASE = 0;
  }
  DeviceTokenTypes type = 1;
  string value = 2;
}

// ############# END USER GROUP #############

// ############# ACCOUNTS GROUP #############

message Account {
  string id = 1;
  Customer customer = 2;
  Product product = 3;
  string name = 4;
  string iban = 5;
  string account_number = 6;
  string code = 7;
  // String format DD-MM-YYYY
  string maturity_date = 8;
  AccountBalances balances = 9;
  AccountMambu mambu = 10;
  AccountFCMB fcmb = 11;
  enum AccountStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  AccountStatuses status = 12;
  google.protobuf.Timestamp status_ts = 13;
  google.protobuf.Timestamp ts = 14;
}

message AccountFCMB {
  string ngn_account_number = 1;
  string cif_id = 2;
}

message AccountMambu {
  string encoded_key = 1;
  string branch_key = 2;
}

message AccountBalances {
  float total_balance = 1;
}

message Product {
  string id = 1;
  enum ProductTypes {
    FIXED_DEPOSIT = 0;
    CURRENT_ACCOUNT = 1;
  }
  ProductTypes type = 2;
  Currency currency = 3;
  string name = 4;
  int32 term_length = 5;
  float interest_rate = 6;
  float minimum_opening_balance = 7;
  ProductMambu mambu = 8;
  enum ProductStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  ProductStatuses status = 9;
  google.protobuf.Timestamp status_ts = 10;
  google.protobuf.Timestamp ts = 11;
}

message ProductMambu {
  string encoded_key = 1;
}

// ############# END ACCOUNTS GROUP #############

// ############# CDD GROUP #############

message CDD {
  string id = 1;
  Customer customer = 2;
  repeated AML amls = 3;
  repeated KYC kycs = 4;
  repeated POA poas = 5;
  enum CDDStatuses {
    PENDING = 0;
    MANUAL_REVIEW = 1;
    APPROVED = 2;
    DECLINED = 3;
  }
  CDDStatuses status = 6;
  google.protobuf.Timestamp status_ts = 7;
  google.protobuf.Timestamp ts = 8;
}

message AML {
  Organization organization = 1;
  string identifier = 2;
  string file = 3;
  string result = 4;
  string public_url = 5;
  repeated AMLAction actions = 6;
  enum AMLStatuses {
    PENDING = 0;
    MANUAL_REVIEW = 1;
    APPROVED = 2;
    DECLINED = 3;
  }
  AMLStatuses status = 7;
  google.protobuf.Timestamp status_ts = 8;
  google.protobuf.Timestamp ts = 9;
}

message KYC {
  Organization organization = 1;
  string identifier = 2;
  string public_url = 3;
  Reports reports = 4;
  repeated KYCAction actions = 5;
  enum KYCStatuses {
    PENDING = 0;
    MANUAL_REVIEW = 1;
    APPROVED = 2;
    DECLINED = 3;
  }
  KYCStatuses status = 6;
  google.protobuf.Timestamp status_ts = 7;
  google.protobuf.Timestamp ts = 8;
}

message Reports {
  enum KYCTypes {
    FACIAL_VIDEO = 0;
    DOCUMENT = 1;
  }
  KYCTypes type = 1;
  string file = 2;
  string result = 3;
  string sub_result = 4;
  string public_url = 5;
  Review review = 6;
  enum ReportStatuses {
    PENDING = 0;
    MANUAL_REVIEW = 1;
    APPROVED = 2;
    DECLINED = 3;
  }
  ReportStatuses status = 7;
  google.protobuf.Timestamp status_ts = 8;
  google.protobuf.Timestamp ts = 9;
}

message Review {
  bool resubmit = 1;
  string message = 2;
  google.protobuf.Timestamp ts = 3;
}

message POA {
  Organization organization = 1;
  string identifier = 2;
  string file = 3;
  string result = 4;
  Review review = 5;
  repeated POAAction actions = 6;
  enum POAStatuses {
    PENDING = 0;
    MANUAL_REVIEW = 1;
    APPROVED = 2;
    DECLINED = 3;
  }
  POAStatuses status = 7;
  google.protobuf.Timestamp status_ts = 8;
  google.protobuf.Timestamp ts = 9;
}

message POAAction {
  enum POAActionTypes {
    CHANGE_STATUS = 0;
  }
  POAActionTypes type = 1;
  Staff reporter = 2;
  enum POAStatuses {
    PENDING = 0;
    MANUAL_REVIEW = 1;
    APPROVED = 2;
    DECLINED = 3;
  }
  POAStatuses target_status = 3;
  string message = 4;
  google.protobuf.Timestamp ts = 5;
}

message AMLAction {
  enum AMLActionTypes {
    CHANGE_STATUS = 0;
  }
  AMLActionTypes type = 1;
  Staff reporter = 2;
  enum AMLStatuses {
    PENDING = 0;
    MANUAL_REVIEW = 1;
    APPROVED = 2;
    DECLINED = 3;
  }
  AMLStatuses target_status = 3;
  string message = 4;
  google.protobuf.Timestamp ts = 5;
}

message KYCAction {
  enum KYCActionTypes {
    CHANGE_STATUS = 0;
  }
  KYCActionTypes type = 1;
  Staff reporter = 2;
  enum KYCStatuses {
    PENDING = 0;
    MANUAL_REVIEW = 1;
    APPROVED = 2;
    DECLINED = 3;
  }
  KYCStatuses target_status = 3;
  string message = 4;
  google.protobuf.Timestamp ts = 5;
}

// ############# END CDD GROUP #############

// ############# TRANSACTIONS GROUP #############

message Transaction {
  string id = 1;
  TransactionType transaction_type = 2;
  string reference = 3;
  repeated TransactionFee fees = 4;
  ExchangeRate exchange_rate = 5;
  TransactionSource source = 6;
  TransactionTarget target = 7;
  string idempotency_key = 8;
  repeated LinkedTransaction linked_transactions = 9;
  enum TransactionStatuses {
    PENDING = 0;
    APPROVED = 1;
    REJECTED = 2;
  }
  TransactionStatuses status = 10;
  google.protobuf.Timestamp status_ts = 11;
  google.protobuf.Timestamp ts = 12;
}

message TransactionTarget {
  Customer customer = 1;
  Beneficiary beneficiary = 2;
  Account account = 3;
  BeneficiaryAccount beneficiary_account = 4;
  float amount = 5;
  float balance_after_transaction = 6;
}

message TransactionSource {
  Customer customer = 1;
  Account account = 2;
  float amount = 3;
  float balance_after_transaction = 4;
}

message TransactionFee {
  string id = 1;
  float amount = 2;
}

message LinkedTransaction {
  string id = 1;
  enum LinkedTransactionTypes {
    DEPOSIT = 0;
    WITHDRAWAL = 1;
    APPLY_FEE = 2;
  }
  LinkedTransactionTypes type = 2;
  Currency currency = 3;
  float amount = 4;
  LinkedTransactionSource source = 5;
  LinkedTransactionTarget target = 6;
  LinkedTransactionMambu mambu = 7;
  LinkedTransactionFCMB fcmb = 8;
  enum LinkedTransactionStatuses {
    PENDING = 0;
    APPROVED = 1;
    REJECTED = 2;
  }
  LinkedTransactionStatuses status = 9;
  google.protobuf.Timestamp status_ts = 10;
  google.protobuf.Timestamp ts = 11;
}

message LinkedTransactionFCMB {
  string transaction_identifier = 1;
}

message LinkedTransactionMambu {
  string transaction_encoded_key = 1;
}

message LinkedTransactionTarget {
  Account account = 1;
  BeneficiaryAccount beneficiaryAccount = 2;
  string account_data = 3;
}

message LinkedTransactionSource {
  Customer customer = 1;
  Account account = 2;
  string account_data = 3;
}

message TransactionType {
  string id = 1;
  string name = 2;
  enum TransactionTypeStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  TransactionTypeStatuses status = 3;
  google.protobuf.Timestamp status_ts = 4;
  google.protobuf.Timestamp ts = 5;
}

message Fee {
  string id = 1;
  TransactionType transaction_type = 2;
  enum FeeTypes {
    FIXED = 0;
    VARIABLE = 1;
  }
  FeeTypes type = 3;
  repeated FeeBoundaries boundaries = 4;
  enum FeeStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  FeeStatuses status = 5;
  google.protobuf.Timestamp status_ts = 6;
  google.protobuf.Timestamp ts = 7;
}

message FeeBoundaries {
  float lower = 1;
  float upper = 2;
  float amount = 3;
  float percentage = 4;
}

message ExchangeRate {
  string id = 1;
  Currency base_currency = 2;
  Currency target_currency = 3;
  float buy_price = 4;
  float sale_price = 5;
  google.protobuf.Timestamp ts = 6;
}

// ############# END TRANSACTIONS GROUP #############

// ############# BENEFICIARIES GROUP #############

message Beneficiary {
  string id = 1;
  Customer customer = 2;
  string name = 3;
  repeated BeneficiaryAccount accounts = 4;
  enum BeneficiaryStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  BeneficiaryStatuses status = 5;
  google.protobuf.Timestamp status_ts = 6;
  google.protobuf.Timestamp ts = 7;
}

message BeneficiaryAccount {
  string id = 1;
  Beneficiary beneficiary = 2;
  string name = 3;
  Account account = 4;
  Currency currency = 5;
  string account_number = 6;
  string code = 7;
  enum BeneficiaryAccountStatuses {
    ACTIVE = 0;
    INACTIVE = 1;
  }
  BeneficiaryAccountStatuses status = 8;
  google.protobuf.Timestamp status_ts = 9;
  google.protobuf.Timestamp ts = 10;
}

// ############# END BENEFICIARIES GROUP #############

// ############# OTHERS GROUP #############

message Currency {
  string id = 1;
  string symbol = 2;
  string code = 3;
  string name = 4;
}

message Country {
  string id = 1;
  string code_alpha2 = 2;
  string code_alpha3 = 3;
  string name = 4;
}

message Content {
  string id = 1;
  enum ContentType {
    GENERAL_TC = 0;
    GBP_ACCOUNT_TC = 1;
    NGN_ACCOUNT_TC = 2;
    VAULT_ACCOUNT_TC = 3;
    PRIVACY_NOTICE = 4;
    FEES_LIMITS = 5;
  }
  ContentType type = 2;
  string link = 3;
  google.protobuf.Timestamp ts = 4;
}

message DefaultResponse {
  bool success = 1;
  int32 code = 2;
}

message DeviceInput {
  string identifier = 1;
  string os = 2;
  string brand = 3;
  repeated DeviceTokenInput tokens = 4;
  repeated DevicePreferencesInput preferences = 5;
}

message DeviceTokenInput {
  types.DeviceToken.DeviceTokenTypes type = 1;
  string value = 2;
}

message DevicePreferencesInput {
  types.DevicePreferences.DevicePreferencesTypes type = 1;
  string value = 2;
}

message PaginationInfo {
  bool has_next_page = 1;
  bool has_previous_page = 2;
  string start_cursor = 3;
  string end_cursor = 4;
}

message JWTClaims {
  enum ClientType {
    APP = 0;
    DASHBOARD = 1;
  }
  ClientType clientType = 1;
  string id = 2;
  string email = 3;
  string device_id = 4;
}

// ############# END OTHERS GROUP #############